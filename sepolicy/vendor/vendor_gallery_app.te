type vendor_gallery_app, domain, coredomain;

app_domain(vendor_gallery_app)
net_domain(vendor_gallery_app)

# Access standard system services
allow vendor_gallery_app app_api_service:service_manager find;
allow vendor_gallery_app audioserver_service:service_manager find;
allow vendor_gallery_app cameraserver_service:service_manager find;
allow vendor_gallery_app drmserver_service:service_manager find;
allow vendor_gallery_app mediaextractor_service:service_manager find;
allow vendor_gallery_app mediaserver_service:service_manager find;
allow vendor_gallery_app mediametrics_service:service_manager find;
allow vendor_gallery_app nfc_service:service_manager find;
allow vendor_gallery_app surfaceflinger_service:service_manager find;

allow vendor_gallery_app hidl_token_hwservice:hwservice_manager find;

allow vendor_gallery_app sysfs_msm_subsys:file { getattr open read map };
allow vendor_gallery_app sysfs_msm_subsys:dir { getattr open read map search };

# Allow to read and execute camera app modules
typeattribute vendor_gallery_app system_executes_vendor_violators;
allow vendor_gallery_app vendor_file:file { rx_file_perms };

# Read and write system app data files passed over Binder.
# Motivating case was /data/data/com.android.settings/cache/*.jpg for
# cropping or taking user photos.
allow vendor_gallery_app system_app_data_file:file { read write getattr };

# Binder call with gpuservice
binder_call(vendor_gallery_app, gpuservice)